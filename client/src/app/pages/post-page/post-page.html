<div class="PostEditor">
  <div *ngIf="isLoading" class="PostEditor__Loading">
    Загрузка...
  </div>

  <div *ngIf="error" class="PostEditor__Error">
    {{ error }}
  </div>

  <div *ngIf="!isLoading" class="PostEditor__Content">
    <!-- Режим просмотра (если пост существует и не в режиме редактирования) -->
    <div *ngIf="article && !isEditMode" class="PostEditor__ViewMode">
      <h1 class="PostEditor__Title">{{ article.title }}</h1>

      <div class="PostEditor__Meta">
        <span class="PostEditor__Category">{{ article.category }}</span>
        <span class="PostEditor__Date">{{ article.createdAt | date }}</span>
      </div>

      <div class="PostEditor__ContentText">
        {{ article.content }}
      </div>

      <div class="PostEditor__ViewActions">
        <button (click)="toggleEditMode()"  class="btn-primary btn-size-compact" >
          Редактировать
        </button>
        <button (click)="deleteArticle()" class="btn-danger btn-size-compact" >
          Удалить
        </button>
      </div>
    </div>

    <!-- Режим редактирования (или создание нового поста) -->
    <form *ngIf="isEditMode || !article" [formGroup]="postForm" (ngSubmit)="onSubmit()" class="PostEditor__EditMode">
      <div class="PostEditor__FormGroup">
        <label for="title">Заголовок</label>
        <input
          id="title"
          type="text"
          formControlName="title"
          placeholder="Название поста"
        />
        <div *ngIf="postForm.get('title')?.invalid && postForm.get('title')?.touched" class="PostEditor__ErrorText">
          Заголовок обязателен (макс. 100 символов)
        </div>
      </div>

      <div class="PostEditor__FormGroup">
        <label for="content">Содержание</label>
        <textarea
          id="content"
          formControlName="content"
          rows="10"
          placeholder="Текст поста..."
        ></textarea>
        <div *ngIf="postForm.get('content')?.invalid && postForm.get('content')?.touched" class="PostEditor__ErrorText">
          Текст обязателен
        </div>
      </div>

     <div class="PostEditor__FormGroup">
      <label for="category">Категория</label>
      <select
        id="category"
        formControlName="category"
        class="PostEditor__Select"
      >
        <option value="" disabled selected>Выберите категорию</option>
        <option *ngFor="let category of categoryOptions" [value]="category.value">
          {{ category.label }}
        </option>
      </select>
    </div>

      <div class="PostEditor__Actions">
        <button type="submit" [disabled]="postForm.invalid" class="btn-primary btn-size-compact" >
          {{ isEditMode ? 'Сохранить' : 'Опубликовать' }}
        </button>
        <button class="btn-tertiary btn-size-compact" (click)="isEditMode ? toggleEditMode() : router.navigate(['/posts'])">Отмена</button>
        <button *ngIf="isEditMode && article"  class="btn-danger btn-size-compact" (click)="deleteArticle()">Удалить</button>
      </div>
    </form>
  </div>
</div>
